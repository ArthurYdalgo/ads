{"version":3,"sources":["webpack://@flagrow/ads/webpack/bootstrap","webpack://@flagrow/ads/./admin.js","webpack://@flagrow/ads/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flagrow/ads/./src/admin/addAdsPane.js","webpack://@flagrow/ads/./src/admin/components/AdsPage.js","webpack://@flagrow/ads/./src/admin/index.js","webpack://@flagrow/ads/external \"flarum.core.compat['Component']\"","webpack://@flagrow/ads/external \"flarum.core.compat['app']\"","webpack://@flagrow/ads/external \"flarum.core.compat['components/AdminLinkButton']\"","webpack://@flagrow/ads/external \"flarum.core.compat['components/AdminNav']\"","webpack://@flagrow/ads/external \"flarum.core.compat['components/Alert']\"","webpack://@flagrow/ads/external \"flarum.core.compat['components/Button']\"","webpack://@flagrow/ads/external \"flarum.core.compat['extend']\"","webpack://@flagrow/ads/external \"flarum.core.compat['utils/saveSettings']\""],"names":["app","routes","path","component","extensionSettings","m","route","extend","prototype","items","add","href","icon","children","description","translator","trans","UploadPage","init","settings","data","values","settingsPrefix","positions","forEach","key","prop","addPrefix","view","className","onsubmit","bind","value","oninput","withAttr","map","position","placeholder","type","loading","disabled","changed","positionsChecked","some","settingsChecked","e","preventDefault","alerts","dismiss","successAlert","saveSettings","then","show","catch","redraw","initializers","addAdsPane"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./admin.js\");\n","export * from './src/admin';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import {extend} from \"flarum/extend\";\nimport AdminNav from \"flarum/components/AdminNav\";\nimport AdminLinkButton from \"flarum/components/AdminLinkButton\";\nimport AdsPage from './components/AdsPage';\n\nexport default function () {\n    // create the route\n    app.routes['flagrow-ads'] = {path: '/flagrow/ads', component: AdsPage.component()};\n\n    // bind the route we created to the three dots settings button\n    app.extensionSettings['flagrow-ads'] = () => m.route(app.route('flagrow-ads'));\n\n    extend(AdminNav.prototype, 'items', items => {\n        items.add('flagrow-ads', AdminLinkButton.component({\n            href: app.route('flagrow-ads'),\n            icon: 'fas fa-audio-description',\n            children: 'Ads',\n            description: app.translator.trans('flagrow-ads.admin.tab.description')\n        }));\n    });\n}\n","import Component from \"flarum/Component\";\nimport Button from \"flarum/components/Button\";\nimport saveSettings from \"flarum/utils/saveSettings\";\nimport Alert from \"flarum/components/Alert\";\n\nexport default class UploadPage extends Component {\n\n    init() {\n        // get the saved settings from the database\n        const settings = app.data.settings;\n\n        this.values = {};\n\n        // our package prefix (to be added to every field and checkbox in the setting table)\n        this.settingsPrefix = 'flagrow.ads';\n\n        this.positions = [\n            'under-header',\n            'between-posts',\n            'under-nav-items'\n        ];\n\n        this.settings = [\n    \t    'start-from-post',\n            'between-n-posts'\n        ];\n\n        // bind the values of the fields and checkboxes to the getter/setter functions\n        this.positions.forEach(key =>\n            this.values[key] = m.prop(settings[this.addPrefix(key)])\n        );\n        this.settings.forEach(key =>\n            this.values[key] = m.prop(settings[this.addPrefix(key)])\n        );\n    }\n\n    /**\n     * Show the actual ImageUploadPage.\n     *\n     * @returns {*}\n     */\n    view() {\n        return [\n            m('div', {className: 'AdsPage'}, [\n                m('form', {onsubmit: this.onsubmit.bind(this)},\n\n                    m('fieldset', {className: 'AdsPage-settings'}, [\n                        m('legend', {}, app.translator.trans('flagrow-ads.admin.settings.start-from-post')),\n                        m('input', {\n                            value: this.values['start-from-post']() || 1,\n                            className: 'FormControl',\n                            oninput: m.withAttr('value', this.values['start-from-post'])\n                        })\n                    ]),\n\n                    m('fieldset', {className: 'AdsPage-settings'}, [\n                        m('legend', {}, app.translator.trans('flagrow-ads.admin.settings.between-n-posts')),\n                        m('input', {\n                            value: this.values['between-n-posts']() || 5,\n                            className: 'FormControl',\n                            oninput: m.withAttr('value', this.values['between-n-posts'])\n                        })\n                    ]),\n\n                    this.positions.map(position => {\n                        return m('fieldset', {className: 'AdsPage-' + position}, [\n                            m('legend', {}, app.translator.trans('flagrow-ads.admin.positions.' + position + '.title')),\n                            m('textarea', {\n                                value: this.values[position]() || null,\n                                className: 'FormControl',\n                                placeholder: app.translator.trans('flagrow-ads.admin.positions.' + position + '.placeholder'),\n                                oninput: m.withAttr('value', this.values[position])\n                            })\n                        ])\n                    }),\n\n                    Button.component({\n                        type: 'submit',\n                        className: 'Button Button--primary',\n                        children: app.translator.trans('flagrow-ads.admin.buttons.save'),\n                        loading: this.loading,\n                        disabled: !this.changed()\n                    }),\n                ),\n            ])\n        ];\n    }\n\n    /**\n     * Checks if the values of the fields and checkboxes are different from\n     * the ones stored in the database\n     *\n     * @returns boolean\n     */\n    changed() {\n        var positionsChecked = this.positions.some(key => this.values[key]() !== app.data.settings[this.addPrefix(key)]);\n        var settingsChecked = this.settings.some(key => this.values[key]() !== app.data.settings[this.addPrefix(key)]);\n        return positionsChecked || settingsChecked;\n    }\n\n    /**\n     * Saves the settings to the database and redraw the page\n     *\n     * @param e\n     */\n    onsubmit(e) {\n        // prevent the usual form submit behaviour\n        e.preventDefault();\n\n\n        // if the page is already saving, do nothing\n        if (this.loading) return;\n\n        // prevents multiple savings\n        this.loading = true;\n\n        // remove previous success popup\n        app.alerts.dismiss(this.successAlert);\n\n        const settings = {};\n\n        // gets all the values from the form\n        this.positions.forEach(key => settings[this.addPrefix(key)] = this.values[key]());\n        this.settings.forEach(key => settings[this.addPrefix(key)] = this.values[key]());\n\n        // actually saves everything in the database\n        saveSettings(settings)\n            .then(() => {\n                // on success, show popup\n                app.alerts.show(this.successAlert = new Alert({\n                    type: 'success',\n                    children: app.translator.trans('core.admin.basics.saved_message')\n                }));\n            })\n            .catch(() => {\n            })\n            .then(() => {\n                // return to the initial state and redraw the page\n                this.loading = false;\n                m.redraw();\n            });\n    }\n\n    addPrefix(key) {\n        return this.settingsPrefix + '.' + key;\n    }\n}\n","import {extend} from \"flarum/extend\";\nimport app from \"flarum/app\";\nimport addAdsPane from \"./addAdsPane\";\n\napp.initializers.add('flagrow-ads', () => {\n    // add the admin pane\n    addAdsPane();\n});\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/AdminLinkButton'];","module.exports = flarum.core.compat['components/AdminNav'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['utils/saveSettings'];"],"sourceRoot":""}